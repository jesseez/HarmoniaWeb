(this["webpackJsonpharmonia-web"]=this["webpackJsonpharmonia-web"]||[]).push([[0],{30:function(e,t,n){e.exports=n(42)},35:function(e,t,n){},36:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),s=n(12),o=n.n(s),r=(n(35),n(26)),u=n(2),l=(n(36),n(4)),h=n(6),c=n(28),d=n(27),y=n(56),f=n(16),w=window.AudioContext||window.webkitAudioContext,p=function(){function e(){Object(l.a)(this,e),this.notePlayerConnectionPool=[],this.filterNode=e.audioContext.createDynamicsCompressor(),this.filterNode.connect(e.audioContext.destination)}return Object(h.a)(e,[{key:"getNotePlayer",value:function(){var e=this.notePlayerConnectionPool.find((function(e){return e.available}));return null==e&&(e=new v(this._createNotePlayer())),e.available=!1,e.notePlayer}},{key:"_createNotePlayer",value:function(){var t=e.audioContext.createOscillator(),n=e.audioContext.createGain();return n.connect(this.filterNode),t.connect(n),new g(t,n,this.filterNode,e.audioContext)}},{key:"returnNotePlayer",value:function(e){var t=this.notePlayerConnectionPool.find((function(t){return t.notePlayer===e}));null!=t&&(t.available=!0)}}]),e}();p.audioContext=new w;var v=function e(t){Object(l.a)(this,e),this.notePlayer=t,this.available=!0},g=function(){function e(t,n,i,a){Object(l.a)(this,e),this.oscillator=t,this.gainNode=n,this.filterNode=i,this.audioContext=a}return Object(h.a)(e,[{key:"setFrequency",value:function(e){this.oscillator.frequency.value=e}},{key:"start",value:function(){this.gainNode.gain.setValueAtTime(.001,this.getCurrentTime()),this.oscillator.start(),this.gainNode.gain.exponentialRampToValueAtTime(.2,this.getCurrentTime()+.01)}},{key:"stop",value:function(e){e?(this.gainNode.gain.linearRampToValueAtTime(.001,e),this.oscillator.stop(e)):(this.gainNode.gain.setTargetAtTime(.001,this.getCurrentTime(),.01),this.oscillator.stop(this.getCurrentTime()+.05))}},{key:"onEnded",value:function(e){this.oscillator.onended=e}},{key:"getCurrentTime",value:function(){return this.audioContext.currentTime}}]),e}(),m=function(e,t){return _(e.noteLength,t)},_=function(e,t){return 1/(t/60)*e},P=function(){function e(){Object(l.a)(this,e),this.notePlayerPool=new p,this._notePlayersInUse=[]}return Object(h.a)(e,[{key:"play",value:function(e,t,n){var i=this.notePlayerPool.getNotePlayer();this._notePlayersInUse.push(i),i.setFrequency(e.getFrequency()),i.start();var a=m(e,t);i.stop(i.getCurrentTime()+a),i.onEnded(function(){this._freeNotePlayer.bind(this,i),n&&n()}.bind(this))}},{key:"_freeNotePlayer",value:function(e){this.notePlayerPool.returnNotePlayer(e),this._notePlayersInUse.splice(this._notePlayersInUse.indexOf(e),1)}},{key:"stop",value:function(){this._notePlayersInUse.forEach((function(e){return e.stop()}))}}]),e}();(function(){function e(){Object(l.a)(this,e),this.audioPlayer=new P,this.song=[],this._scheduledEvents=[],this.state=e.state.ready,this._startTime=0,this._startLocation=0,this.tempo=120}return Object(h.a)(e,[{key:"reset",value:function(){this._scheduledEvents=[],this.state=e.state.ready,this._startTime=0,this._startLocation=0}},{key:"isPlaying",value:function(){return this.state===e.state.playing}},{key:"isEnded",value:function(){return this.state===e.state.ended}},{key:"setSong",value:function(e){this.song=e,this.reset()}},{key:"setTempo",value:function(e){if(null!=e){var t=this.isPlaying(),n=this.tempo;this.tempo=e,this.pause(),this._startLocation=this._startLocation*n/e,t&&this.play()}}},{key:"play",value:function(){if(this.isEnded()&&(this.state=e.state.ready),0!==this.song.length&&!this.isPlaying()&&!this.isEnded()){this._startTime=Date.now(),this.state=e.state.playing;var t,n=0,i=Object(f.a)(this.song);try{for(i.s();!(t=i.n()).done;){var a=t.value,s=1e3*m(a,this.tempo);0!==a.noteValue&&n+s>=this._startLocation&&this._scheduledEvents.push(setTimeout(this._playNote.bind(this),n-this._startLocation,a)),n+=s}}catch(o){i.e(o)}finally{i.f()}}}},{key:"_playNote",value:function(e){this.audioPlayer.play(e,this.tempo,this._onNoteEnd.bind(this,e))}},{key:"_onNoteEnd",value:function(t){t===this.song[this.song.length-1]&&(this.state=e.state.ended)}},{key:"pause",value:function(){if(this.state===e.state.playing){this.state=e.state.paused;var t=Date.now();this._startLocation=t-this._startTime,this._scheduledEvents.forEach((function(e){return clearTimeout(e)})),this._scheduledEvents=[]}}}]),e}()).state={ready:"ready",playing:"playing",paused:"paused",ended:"ended"};var k=function(){function e(){Object(l.a)(this,e),this.audioPlayer=new P,this.state=e.state.ready,this._currentIndex=0,this.tempo=120}return Object(h.a)(e,[{key:"reset",value:function(){this._scheduledEvents=[],this.state=e.state.ready,this._currentIndex=0}},{key:"isReady",value:function(){return this.state===e.state.ready}},{key:"isPlaying",value:function(){return this.state===e.state.playing}},{key:"isEnded",value:function(){return this.state===e.state.ended}},{key:"isPaused",value:function(){return this.state===e.state.paused}},{key:"setSong",value:function(e){this.song=e,this._convertSongIntoMap(e),this.reset()}},{key:"_convertSongIntoMap",value:function(e){var t,n=[],i=Object(f.a)(e);try{var a=function(){var e=t.value,i=n.find((function(t){return t.startTime===e.startTime}));null==i&&(i=new b(e.startTime),n.push(i)),i.notes.push(e)};for(i.s();!(t=i.n()).done;)a()}catch(s){i.e(s)}finally{i.f()}n.sort((function(e,t){return e.startTime-t.startTime})),this.structuredSong=n}},{key:"setTempo",value:function(e){null==e||this.isPlaying()||(this.tempo=e)}},{key:"play",value:function(){if(this.isEnded())this.state=e.state.playing,this._currentIndex=0;else if(this.isReady()||this.isPaused())this.state=e.state.playing;else if(0===this.structuredSong.length)return;this.playImpl()}},{key:"playImpl",value:function(){if(!this.isPaused()){var e,t=this.structuredSong[this._currentIndex],n=Object(f.a)(t.notes);try{for(n.s();!(e=n.n()).done;){var i=e.value;this._playNote(i)}}catch(o){n.e(o)}finally{n.f()}if(this._currentIndex++,this.structuredSong.length!==this._currentIndex){var a=this.structuredSong[this._currentIndex].startTime-t.startTime,s=1e3*_(a,this.tempo);setTimeout(this.playImpl.bind(this),s)}}}},{key:"_playNote",value:function(e){this.audioPlayer.play(e,this.tempo,this._onNoteEnd.bind(this,e))}},{key:"_onNoteEnd",value:function(t){t===this.structuredSong[this.structuredSong.length-1].notes.reduce((function(e,t){return Math.max(e.noteLength,t.noteLength)}))&&(this.state=e.state.ended)}},{key:"pause",value:function(){this.state===e.state.playing&&(this.state=e.state.paused,this._currentIndex--)}}]),e}();k.state={ready:"ready",playing:"playing",paused:"paused",ended:"ended"};var b=function e(t){Object(l.a)(this,e),this.startTime=t,this.notes=[]},T=function(){function e(t,n,i){Object(l.a)(this,e),this.noteValue=t,this.noteLength=n,this.startTime=i}return Object(h.a)(e,[{key:"getFrequency",value:function(){return e._baseFrequency*Math.pow(e._frequencyStep,this.noteValue-e._baseNoteValue)}}]),e}();T._frequencyStep=Math.pow(2,1/12),T._baseFrequency=440,T._baseNoteValue=58;var N=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(l.a)(this,n),(e=t.call(this)).songPlayer=new k;var i=E.map((function(e){return new T(e.noteValue+12,e.noteLength,e.startTime)}));return e.songPlayer.setSong(i),e.songPlayer.setTempo(120),e}return Object(h.a)(n,[{key:"startAudio",value:function(){this.songPlayer.play()}},{key:"stopAudio",value:function(){this.songPlayer.pause()}},{key:"render",value:function(){return a.a.createElement("div",null,"HI",a.a.createElement(y.a,{onClick:this.startAudio.bind(this)},"play"),a.a.createElement(y.a,{onClick:this.stopAudio.bind(this)},"pause"))}}]),n}(a.a.Component),E=[new T(53,1,0),new T(61,1.5,1),new T(60,.5,2.5),new T(58,.5,3),new T(53,.5,3.5),new T(58,1.5,4),new T(53,1.5,5.5),new T(46,1,7),new T(51,1.5,8),new T(54,1,9.5),new T(51,.5,10.5),new T(54,.5,11),new T(49,.5,11.5),new T(48,2.5,12),new T(34,4,0),new T(41,4,0),new T(37,4,4),new T(42,4,4),new T(39,4,8),new T(46,4,8),new T(32,4,12),new T(39,4,12),new T(46,.5,14.5),new T(51,.5,15),new T(58,.5,15.5),new T(53,1,16),new T(61,1.5,17),new T(68,.5,18.5),new T(70,.5,19),new T(61,.5,19.5),new T(66,1.5,20),new T(65,1.5,21.5),new T(58,.5,23),new T(49,.5,23.5),new T(51,1.5,24),new T(53,1,25.5),new T(49,.5,26.5),new T(48,.5,27),new T(44,.5,27.5),new T(46,1.5,28),new T(44,2,29.5),new T(34,4,16),new T(41,4,16),new T(37,4,20),new T(42,4,20),new T(39,4,24),new T(46,4,24),new T(32,4,28),new T(39,4,28),new T(61,1,13.5),new T(63,.25,14.5),new T(65,.25,14.75),new T(66,.25,15),new T(68,.25,15.25),new T(70,.25,15.5),new T(72,.25,15.75),new T(70,4,16),new T(73,4,16),new T(73,4,20),new T(77,4,20),new T(70,4,24),new T(75,4,24),new T(63,4,28),new T(68,4,28)];var x=function(){return a.a.createElement(r.a,{basename:"/"},a.a.createElement("div",{className:"App"},a.a.createElement(u.a,{exact:!0,path:"/",component:N})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.629fc9cc.chunk.js.map